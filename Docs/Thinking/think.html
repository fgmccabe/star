<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright (C) 2019 and beyond, Francis G. McCabe

All rights reserved. -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Programming in Star</title>

<meta name="description" content="Programming in Star">
<meta name="keywords" content="Programming in Star">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="#Why-Star_003f" rel="start" title="Why Star?">
<link href="#SEC_Contents" rel="contents" title="Table of Contents">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<h1 class="settitle" align="center">Programming in Star</h1>





<a name="SEC_Overview"></a>
<h2 class="shortcontents-heading">Short Table of Contents</h2>

<div class="shortcontents">
<ul class="no-bullet">
<li><a name="stoc-Why-Star_003f-1" href="#toc-Why-Star_003f-1">1 Why Star?</a></li>
<li><a name="stoc-Functional-Programming-1" href="#toc-Functional-Programming-1">2 Functional Programming</a></li>
<li><a name="stoc-Contract-Oriented-Programming-1" href="#toc-Contract-Oriented-Programming-1">3 Contract Oriented Programming</a></li>

</ul>
</div>

<a name="SEC_Contents"></a>
<h2 class="contents-heading">Table of Contents</h2>

<div class="contents">
<ul class="no-bullet">
<li><a name="toc-Why-Star_003f-1" href="#Why-Star_003f">1 Why Star?</a>
<ul class="no-bullet">
  <li><a name="toc-Texture-1" href="#Texture">1.1 Texture</a>
  <ul class="no-bullet">
    <li><a name="toc-Higher-Order-Functions-1" href="#Higher-Order-Functions">1.1.1 Higher Order Functions</a></li>
    <li><a name="toc-Patterns-1" href="#Patterns">1.1.2 Patterns</a></li>
    <li><a name="toc-Defining-Types-1" href="#Defining-Types">1.1.3 Defining Types</a></li>
    <li><a name="toc-Collections-1" href="#Collections">1.1.4 Collections</a></li>
    <li><a name="toc-Comprehensions-1" href="#Comprehensions">1.1.5 Comprehensions</a></li>
  </ul></li>
  <li><a name="toc-A-Little-Context-1" href="#A-Little-Context">1.2 A Little Context</a>
  <ul class="no-bullet">
    <li><a name="toc-All-Projects-are-Team-Projects-1" href="#All-Projects-are-Team-Projects">1.2.1 All Projects are Team Projects</a></li>
    <li><a name="toc-Requirements-Change-and-Systems-Evolve-1" href="#Requirements-Change-and-Systems-Evolve">1.2.2 Requirements Change and Systems Evolve</a></li>
  </ul></li>
  <li><a name="toc-Star-is-Rich-1" href="#Star-is-Rich">1.3 Star is Rich</a></li>
</ul></li>
<li><a name="toc-Functional-Programming-1" href="#Functional-Programming">2 Functional Programming</a>
<ul class="no-bullet">
  <li><a name="toc-Functional-First-1" href="#Functional-First">2.1 Functional First</a></li>
  <li><a name="toc-Equations-as-Cases-1" href="#Equations-as-Cases">2.2 Equations as Cases</a></li>
  <li><a name="toc-Equations-as-State-1" href="#Equations-as-State">2.3 Equations as State</a></li>
  <li><a name="toc-Verbs-as-well-as-Nouns-1" href="#Verbs-as-well-as-Nouns">2.4 Verbs as well as Nouns</a></li>
  <li><a name="toc-Non_002dsequential-Code-1" href="#Non_002dsequential-Code">2.5 Non-sequential Code</a></li>
</ul></li>
<li><a name="toc-Contract-Oriented-Programming-1" href="#Contract-Oriented-Programming">3 Contract Oriented Programming</a>
<ul class="no-bullet">
  <li><a name="toc-Contracts-as-Interfaces-1" href="#Contracts-as-Interfaces">3.1 Contracts as Interfaces</a></li>
  <li><a name="toc-Accessing-Collections-1" href="#Accessing-Collections">3.2 Accessing Collections</a></li>
</ul></li>

</ul>
</div>











<p>Star is a functional, multi-paradigm and extensible programming
language. It is a full-scale language, capable of expressing many
kinds of program. As such it is a rich language with many features.
Star was originally developed as part of a framework for processing a
range of real-time business applications such as factory scheduling
and data analytics.  This white paper explores some of the basic
features of the language and shows by example how it can be used to
solve problems.
</p>
<a name="Why-Star_003f"></a>
<div class="header">
<p>
Next: <a href="#Functional-Programming" accesskey="n" rel="next">Functional Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Why-Star_003f-1"></a>
<h2 class="chapter">1 Why Star?</h2>

<p>Star is first of all a general purpose programming language. You can
use it to effectively solve problems in many domains. Star was
originally developed to help write analytical and statistical
applications. However, it has evolved into a general purpose
problem-oriented programming language.<a name="DOCF1" href="#FOOT1"><sup>1</sup></a> Many of the features
and functionalities of the platform are expressed in a way that is
consistent with Star. As such, it plays a key role in enabling the
different elements of an application built on the platform to work
smoothly together.
</p>
<p>Like any programming language, Star represents a distinct view point
on what programming languages should be. Star is a rich
functional-first language with carefully constructed semantics. Star
is designed to be readable, powerful, safe and extensible.
</p>
<p>Performance is also important, of course. However, we view performance
as being guided by the principle of &lsquo;fast enough is good enough&rsquo;.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Texture" accesskey="1">Texture</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#A-Little-Context" accesskey="2">A Little Context</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Star-is-Rich" accesskey="3">Star is Rich</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Texture"></a>
<div class="header">
<p>
Next: <a href="#A-Little-Context" accesskey="n" rel="next">A Little Context</a>, Up: <a href="#Why-Star_003f" accesskey="u" rel="up">Why Star?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Texture-1"></a>
<h3 class="section">1.1 Texture</h3>
<p>All programming languages can be said to have a particular style or
texture. This is often so strong that it only needs a single line of
source code to be able to identify a programming language. In the case
of Star, this line might be (we explain what it means a bit later on):
</p>
<div class="example">
<pre class="example">factorial:all t ~~ arith[t] |: (t)=&gt;t.
</pre></div>

<p>This is a <em>type annotation</em>: a description of the type of a
variable &ndash; in this case <code>factorial</code>. It is a function type &ndash;
which means that we can call <code>factorial</code>. It is also, somewhat
unusually for factorial, <em>generic</em>: the factorial of any type can
be computed &ndash; provided that arithmetic has been implemented for it.
</p>
<p>Overall, the texture of Star is designed to enhance the readability of
programs. Readability is important because many people have to be able
to read programs; perhaps more than are involved in writing them. Even
with an emphasis on readability, the power of the language is such
that Star programs tend to be shorter than their equivalents written
in languages like Java.
</p>
<p>This is a function definition that should be more straightforward to
understand:
</p><div class="example">
<pre class="example">doubleMe:(integer)=&gt;integer.
doubleMe(x) =&gt; x + x.
</pre></div>

<p>Although not mandatory, in most cases we strongly favor a programming
style where the type of functions and other top-level definitions are
called out explicitly. Here is another function calling the
just-defined <code>doubleMe</code>:
</p>
<div class="example">
<pre class="example">doubleUs:(integer,integer)=&gt;integer.
doubleUs(x, y) =&gt; doubleMe(x) + doubleMe(y).
</pre></div>

<p>A complete Star program that uses the <code>doubleMe</code> and
<code>doubleUs</code> functions to print a result is:
</p><div class="example">
<pre class="example">sample.first{
  doubleMe:(integer)=&gt;integer.
  doubleMe(x) =&gt; x + x.

  doubleUs:(integer,integer)=&gt;integer.
  doubleUs(x, y) =&gt; doubleMe(x) + doubleMe(y).

  main:()=&gt;action[(),()].
  main() =&gt; do {
    logMsg(info,&quot;double trouble is $(doubleUs(3,4))&quot;)
  }
}
</pre></div>

<p>Function definitions can use multiple clauses, pattern matching, and guards:
</p><div class="example">
<pre class="example">lucky:(integer)=&gt;string.
lucky(7) =&gt; &quot;LUCKY NUMBER SEVEN!&quot;.
lucky(x) default =&gt; &quot;Sorry, youâre out of luck, pal!&quot;

fctrl:(integer)=&gt;integer.
fctrl(0) =&gt; 1.
fctrl(n) where n &gt; 0 =&gt; n * fctrl(n-1)
</pre></div>
<p>In fact, this last function is not fully paradigmatic of Star. A
better, albeit more complex, version of this would be:
</p><div class="example">
<pre class="example">factorial:all t ~~ arith[t] |: (t)=&gt;t.
factorial(zero) =&gt; one.
factorial(n) where n &gt; zero =&gt; n * factorial(n-one)
</pre></div>
<p>This version of factorial will work with integers, floats anything
that can do arithmetic. Here we use special variables <code>zero</code> and
<code>one</code> to denote 0 and 1 in a type-agnostic way.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Higher-Order-Functions" accesskey="1">Higher Order Functions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Patterns" accesskey="2">Patterns</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Defining-Types" accesskey="3">Defining Types</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Collections" accesskey="4">Collections</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Comprehensions" accesskey="5">Comprehensions</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Higher-Order-Functions"></a>
<div class="header">
<p>
Next: <a href="#Patterns" accesskey="n" rel="next">Patterns</a>, Up: <a href="#Texture" accesskey="u" rel="up">Texture</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Higher-Order-Functions-1"></a>
<h4 class="subsection">1.1.1 Higher Order Functions</h4>
<p>Star supports higher-order functions. The following <code>apply</code> function
corresponds to the familiar map function from other functional
languages.
</p><div class="example">
<pre class="example">apply:all s,t ~~ ((s)=&gt;t,cons[s])=&gt;cons[t].
apply(f, nil) =&gt; nil.
apply(f, cons(x, xs)) =&gt;
      cons(f(x), apply(f, xs)).
</pre></div>
<p>Although Star has a sophisticated type system that supports automatic
type inference, we recommend that that programmers supply type
annotations, which often improve readability.
</p>
<blockquote>
<p><b>Note:</b> Specifically, the rule for type inference is that Star will
automatically infer the types of all variables; but will never infer a
<em>generic</em> &ndash; or quantified &ndash; type for functions.
</p>
<p>This represents an interesting balance between convenience &ndash; many
programs are not actually fully generic &ndash; and precision.
</p></blockquote>
<p>So, since <code>apply</code> is supposed to be generic, we are required to
supply a type annotation for it:
</p><div class="example">
<pre class="example">apply:all s,t ~~ ((s)=&gt;t,cons[s])=&gt;cons[t].
</pre></div>
<p>This states that <code>apply</code> is generic in two types, that it takes a
function argument and a <code>cons</code> list argument and returns a new
<code>cons</code> list.
</p>

<hr>
<a name="Patterns"></a>
<div class="header">
<p>
Next: <a href="#Defining-Types" accesskey="n" rel="next">Defining Types</a>, Previous: <a href="#Higher-Order-Functions" accesskey="p" rel="prev">Higher Order Functions</a>, Up: <a href="#Texture" accesskey="u" rel="up">Texture</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Patterns-1"></a>
<h4 class="subsection">1.1.2 Patterns</h4>
<p>Patterns and pattern matching are ubiquitous in Star. Nearly all
literal forms have a pattern equivalent that allows matching and, most
importantly, de-structuring such values.
</p>
<p>For example, we can define functions over collections that allow us to
(say) compute the maximum element in a collection:
</p>
<div class="example">
<pre class="example">maximum:all t ~~ arith[t] |: (list[t],t)=&gt;t.
maximum([H,..T]) =&gt; let {
  max([],Mx) =&gt; Mx.
  max([F,..R],Mx) where F&gt;Mx =&gt; max(R,F).
  max([_,..R],Mx) default =&gt; max(R,Mx).
} in max(T,H)
</pre></div>
<p>The <code>max</code> function enclosed in the <code>let</code> body uses patterns to
match against the successive elements of the collection. 
</p>
<p>The pattern form:
</p><div class="example">
<pre class="example">[H,..T]
</pre></div>
<p>matches any non-empty sequence; and binds the first element of the
sequence to the variable <code>H</code> and the remainder of the sequence to
<code>T</code>.
</p>
<p>The pattern form:
</p><div class="example">
<pre class="example">[]
</pre></div>
<p>only matches an empty collection.
</p>
<p>The <code>maximum</code> function is written in terms of a local function â
<code>max</code> â and a call to that local function. The <code>let</code>
expression is one of the foundations and cornerstones of functional
programming.
</p>
<hr>
<a name="Defining-Types"></a>
<div class="header">
<p>
Next: <a href="#Collections" accesskey="n" rel="next">Collections</a>, Previous: <a href="#Patterns" accesskey="p" rel="prev">Patterns</a>, Up: <a href="#Texture" accesskey="u" rel="up">Texture</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Defining-Types-1"></a>
<h4 class="subsection">1.1.3 Defining Types</h4>
<p>Like most functional languages, Star supports many forms of sequence
collection natively. One of the more common kinds of list is the âcons
listâ a.k.a. single-linked list. Cons lists are defined using a type
definition that introduces the type and its different âshapesâ:
</p>
<div class="example">
<pre class="example">all t ~~ cons[t] ::= nil | cons(t,cons[t]).
</pre></div>

<p>This states that there are two forms of <code>cons</code> lists: the empty cons
list <code>nil</code>, and a pairing <code>cons(x, xs)</code> where <code>x</code> is
the first element, and <code>xs</code> is the rest of the list. The
<code>all</code> quantifier at the beginning of the declaration of the <code>cons</code>
type marks the type as a generic type â specifically a universal type.
</p>
<p>All Star values can be written as literals, including user defined
types like cons. For example, the <code>cons</code> list:
</p>
<div class="example">
<pre class="example">cons(&quot;alpha&quot;,cons(&quot;beta&quot;,cons(&quot;gamma&quot;,nil)))
</pre></div>
<p>contains the strings <code>&quot;alpha&quot;</code>, <code>&quot;beta&quot;</code> and <code>&quot;gamma&quot;</code>.
</p>
<p>The standard implementation of <code>cons</code> lists in Star also supports
the sequence notation we saw above. So, this list can also be written:
</p><div class="example">
<pre class="example">[&quot;alpha&quot;, &quot;beta&quot;, &quot;gamma&quot;]:cons[string]
</pre></div>
<p>Note that we are not allowed to mix strings and integers in the same
list. That is because Star is strongly, statically typed and requires
all elements of a list to have the same type.
</p>
<p>Just as with sequences, we can define functions over <code>cons</code> lists via
pattern matching:
</p><div class="example">
<pre class="example">maxCons:(cons[integer]) =&gt; integer.
maxCons(cons(x, nil)) =&gt; x.
maxCons(cons(x, xs)) default =&gt; let {
     maxRest = maxCons(xs).
   } in (x &gt; maxRest ? x || maxRest)
</pre></div>
   
<p>The first <code>maxCons</code> equation is for <code>cons</code> lists with one
element, where <code>maxCons</code> simply returns that element. The second
equation first computes the maximum of the rest of the list via a
recursive call, and uses a conditional expression to compute the
maximum for the entire list.
</p>
<p>The expression
</p><div class="example">
<pre class="example">(x &gt; maxRest ? x || maxRest)
</pre></div>
<p>is a conditional expression: if <code>x</code> is greater than
<code>maxRest</code> then it is the maximum; otherwise <code>maxRest</code>
is. This is an example of a very well known form of expression that
uses symbolic operators rather than keywords.
</p>
<hr>
<a name="Collections"></a>
<div class="header">
<p>
Next: <a href="#Comprehensions" accesskey="n" rel="next">Comprehensions</a>, Previous: <a href="#Defining-Types" accesskey="p" rel="prev">Defining Types</a>, Up: <a href="#Texture" accesskey="u" rel="up">Texture</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Collections-1"></a>
<h4 class="subsection">1.1.4 Collections</h4>
<p>Star has a standard way of writing sequences and collections â like
lists and dictionaries. For example, the expression
</p><div class="example">
<pre class="example">[4, 8, 15, 16, 42]:list[integer]
</pre></div>
<p>denotes the list with the numbers 4, 8, 15, 16 and 42 in it. This
notation â which is called the sequence notation â is quite
general. We can denote a different kind of collection, containing cons
elements for example, using:
</p><div class="example">
<pre class="example">[4, 8, 15, 16, 42]:cons[integer]
</pre></div>
<p>or, we can even denote a general collection without being explicit
about the type of collection:
</p><div class="example">
<pre class="example">[4, 8, 15, 16, 42]
</pre></div>
<p>In this last case, the compiler may have to rely on the context to
fully determine the type of the sequence.
</p>
<p>As another example, we can see that a dictionary literal is also a
variation on the collection â except that we have keys as well as
values:
</p><div class="example">
<pre class="example">[ &quot;alpha&quot;-&gt;1, &quot;beta&quot;-&gt;2 ]
</pre></div>

<hr>
<a name="Comprehensions"></a>
<div class="header">
<p>
Previous: <a href="#Collections" accesskey="p" rel="prev">Collections</a>, Up: <a href="#Texture" accesskey="u" rel="up">Texture</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Comprehensions-1"></a>
<h4 class="subsection">1.1.5 Comprehensions</h4>
<p>Star has a built-in query expression notation that allows us to avoid
a lot of common recursive forms of definition. For example, the
<code>apply</code> function can be written more succinctly using:
</p><div class="example">
<pre class="example">apply(f,C) =&gt; { f(X) | X in C }
</pre></div>
<p>the meaning of the expression is equivalent to the recursive
definition we saw of <code>apply</code> above.
</p>
<hr>
<a name="A-Little-Context"></a>
<div class="header">
<p>
Next: <a href="#Star-is-Rich" accesskey="n" rel="next">Star is Rich</a>, Previous: <a href="#Texture" accesskey="p" rel="prev">Texture</a>, Up: <a href="#Why-Star_003f" accesskey="u" rel="up">Why Star?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="A-Little-Context-1"></a>
<h3 class="section">1.2 A Little Context</h3>

<p>The origins of Star lie in a platform that was originally oriented
towards complex event processing applications.<cite>luckham:2012</cite>
StarRules â as it was known then â was a rules language that allowed
one to express CEP-style rules succinctly.
</p>
<p>However, as often happens, requirements evolved and CEP itself became
just one of many application areas that the Starview platform can
address. The same pressures for generality in the platform lead to a
greater interest in extensibility and generality in the programming
language.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#All-Projects-are-Team-Projects" accesskey="1">All Projects are Team Projects</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Requirements-Change-and-Systems-Evolve" accesskey="2">Requirements Change and Systems Evolve</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="All-Projects-are-Team-Projects"></a>
<div class="header">
<p>
Next: <a href="#Requirements-Change-and-Systems-Evolve" accesskey="n" rel="next">Requirements Change and Systems Evolve</a>, Up: <a href="#A-Little-Context" accesskey="u" rel="up">A Little Context</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="All-Projects-are-Team-Projects-1"></a>
<h4 class="subsection">1.2.1 All Projects are Team Projects</h4>

<p>A key observation about successful software projects is that they
involve teams; even if they start out as solo projects, they
invariably become team projects. Furthermore, deployment targets will
often extend to span a range of devices from smart phones to
multi-cluster super computers. Finally, software is rarely completely
useful in isolation: integration with other systems if often key to
realizing the benefits of a given system. These aspects have
continually influenced Starâs design.
</p>
<p>Another strong influence on Star was the social context: We assumed
that any any given software project would involve many people. This
led us to conclude that features such as clear semantics, safety,
strong modularization, and in particular multi-paradigm support are
essential rather than being optional.
</p>
<p>The foundations for safety in a programming language stem from an
expressive type system â the more expressive the type system, the less
the temptation to escape from it â and from an easy-to-reason-about
semantics. These requirements favor primarily functional languages,
especially when it comes to reasoning about parallel and distributed
programming.
</p>
<p>Star is not a pure language in the sense that it permits programs with
assignments and stateful objects. This is both because we wish to
permit programmers to build in ways that suits their needs and because
some algorithms are easier to express using mutable state. However,
the language encourages the programmer to program more
declaratively. Star enables procedural programming whilst constraining
features to avoid some pitfalls of global hidden state.
</p>
<hr>
<a name="Requirements-Change-and-Systems-Evolve"></a>
<div class="header">
<p>
Previous: <a href="#All-Projects-are-Team-Projects" accesskey="p" rel="prev">All Projects are Team Projects</a>, Up: <a href="#A-Little-Context" accesskey="u" rel="up">A Little Context</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Requirements-Change-and-Systems-Evolve-1"></a>
<h4 class="subsection">1.2.2 Requirements Change and Systems Evolve</h4>

<p>One particular scenario played out several times: we developed some
high-level but specific feature that was designed to meet a particular
goal; but, in order to address a slightly different goal we were
forced to evolve to a simpler but more general form.
</p>
<p>For example, initially Star had a high-level concurrency model to
allow multiple agents to process events with some degree of
parallelism. This model was elegant and had an intuitive semantics,
but did not fit certain kinds of applications that we also wanted to
be able to support. At this point we had a choice: to develop
additional forms of concurrency to address the new requirements or to
modify the original.
</p>
<p>We chose to refactor the concurrency model with a more general
one. The main reason being that we could not be certain that other
variants of concurrency would also be important in the future.
</p>
<p>This refactor also had the side-effect of making the concurrency
framework lower-level. This process of replacing specific but
high-level features with more general but lower-level ones occurred
several times: for concurrency, relational data structures and the
rules formalism itself.
</p>
<p>It was partly in response to this that we invested effort in making
the Star language extensible via an extensible grammar and macros. In
effect, we adopted a domain-specific language methodology for the
design of Star itself. Using these extensibility facilities means that
we are often able to present high-level features while basing them on
more general more low-level capabilities.
</p>
<hr>
<a name="Star-is-Rich"></a>
<div class="header">
<p>
Previous: <a href="#A-Little-Context" accesskey="p" rel="prev">A Little Context</a>, Up: <a href="#Why-Star_003f" accesskey="u" rel="up">Why Star?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Star-is-Rich-1"></a>
<h3 class="section">1.3 Star is Rich</h3>

<p>Star is a full-featured language. It is an intentionally rich
language. In addition to the features described here are concurrency
features, data abstraction features that include the concept of
existentially quantified types â that enables abstract data types â
and computation expressions â that are important when designing
systems that rely on being able to delay and control how expressions
are evaluated; and many more.
</p>
<p>In the chapters that follow, we will focus on three major features of
Star that define much of the essence of Star: actors, contracts and
the features needed to extend the syntax and capabilities of Star.
</p>
<hr>
<a name="Functional-Programming"></a>
<div class="header">
<p>
Next: <a href="#Contract-Oriented-Programming" accesskey="n" rel="next">Contract Oriented Programming</a>, Previous: <a href="#Why-Star_003f" accesskey="p" rel="prev">Why Star?</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Functional-Programming-1"></a>
<h2 class="chapter">2 Functional Programming</h2>

<p>Functional programming has roots that go back to the origins of
programming itself. However, it has been recently gaining in
prominence because of some of the inherent advantages in the paradigm:
</p>
<blockquote>
<p>Its &lsquo;declarative&rsquo; nature makes reasoning about functional programs
easier than for &lsquo;procedural&rsquo; programs.
</p></blockquote>

<p>This benefits programmers in a surprising number of ways. Of course,
the most obvious one is that correctness and type safety are easier to
establish than for a program built out of assignment and for-loops.
</p>
<p>A subtler but equally critical benefit is that it can make programming
itself easier: the programmer is free to focus on sub-problems without
unnecessary entanglement with other sub-problems.
</p>
<p>The impact of this benefit can be quite dramatic: similar in effect to
the introduction of garbage collected memory compared to managed
memory allocation.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Functional-First" accesskey="1">Functional First</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Equations-as-Cases" accesskey="2">Equations as Cases</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Equations-as-State" accesskey="3">Equations as State</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Verbs-as-well-as-Nouns" accesskey="4">Verbs as well as Nouns</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Non_002dsequential-Code" accesskey="5">Non-sequential Code</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Functional-First"></a>
<div class="header">
<p>
Next: <a href="#Equations-as-Cases" accesskey="n" rel="next">Equations as Cases</a>, Up: <a href="#Functional-Programming" accesskey="u" rel="up">Functional Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Functional-First-1"></a>
<h3 class="section">2.1 Functional First</h3>
<p>Star is a &lsquo;functional-first&rsquo; programming language. What this means is
that Star makes it easier and more natural to write in a functional
style. However, not all problems are best addressed in the functional
way and it is certainly possible to write procedural Star programs.
</p>
<hr>
<a name="Equations-as-Cases"></a>
<div class="header">
<p>
Next: <a href="#Equations-as-State" accesskey="n" rel="next">Equations as State</a>, Previous: <a href="#Functional-First" accesskey="p" rel="prev">Functional First</a>, Up: <a href="#Functional-Programming" accesskey="u" rel="up">Functional Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Equations-as-Cases-1"></a>
<h3 class="section">2.2 Equations as Cases</h3>

<p>Many functional programming languages â including Star â are based on
an &lsquo;equational style&rsquo;. Equational programs are written as a series of
equations; for example, in the credit function:
</p>
<div class="example">
<pre class="example">credit:(customer)=&gt;float.
credit(C) where inGoodStanding(C) =&gt; 0.15.
credit(C) where inDefault(C) =&gt; -0.1.
  ...
credit(_) default =&gt; 0.0.
</pre></div>
<p>Each line of this definition is an equation. It specifies the meaning
of the credit function in a restricted setting â the complete function
is understood by combining the cases together.
</p>
<p>Using equations we can separate out the different cases for the
customer&rsquo;s credit and &lsquo;work on them separately&rsquo;. This allows the
programmer to focus attention and allows for rapid editing and
reorganization should the need arise.  Case-based approaches to
programming are significantly more productive than traditional
if-then-else procedural programming.
</p>
<hr>
<a name="Equations-as-State"></a>
<div class="header">
<p>
Next: <a href="#Verbs-as-well-as-Nouns" accesskey="n" rel="next">Verbs as well as Nouns</a>, Previous: <a href="#Equations-as-Cases" accesskey="p" rel="prev">Equations as Cases</a>, Up: <a href="#Functional-Programming" accesskey="u" rel="up">Functional Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Equations-as-State-1"></a>
<h3 class="section">2.3 Equations as State</h3>

<p>Contrary to some expectations, it is possible to write stateful
programs in a functional style. The difference is that you have to be
explicit about the state. For example, the function:
</p>
<div class="example">
<pre class="example">addAll:(integer,integer)=&gt;integer.
addAll(from,to) =&gt; let{
  accum(ix,acc) where ix&gt;=to =&gt; acc.
  accum(ix,acc) =&gt; accum(ix+1,acc+ix).
} in accum(from,0).
</pre></div>
<p>is the &lsquo;functional equivalent&rsquo; of the normal Java loop:
</p><div class="example">
<pre class="example">int addAll(int from,int to){
  int acc = 0;
  for(int ix=from;ix&lt;to;ix++)
    acc = acc+ix;
  return acc;
}
</pre></div>
<p>Apart from the use of recursion, the other main difference is that the
&lsquo;state&rsquo; â which in both cases is held in the acc variable â is
explicitly handed down the functional program, whereas the Java
program handles state implicitly.
</p>
<p>The issue for the Java programmer is that what works for simple
programs can become unmanageable for complex multi-threaded
systems. On the other hand, while the functional programmer may be
more burdened for simple cases, complex parallel programs are not much
harder than the simple case.
</p>
<p>Functional programming, with its declarative and explicit manipulation
of state makes crafting parallel programs significantly simpler and
less error-prone.
</p>
<hr>
<a name="Verbs-as-well-as-Nouns"></a>
<div class="header">
<p>
Next: <a href="#Non_002dsequential-Code" accesskey="n" rel="next">Non-sequential Code</a>, Previous: <a href="#Equations-as-State" accesskey="p" rel="prev">Equations as State</a>, Up: <a href="#Functional-Programming" accesskey="u" rel="up">Functional Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Verbs-as-well-as-Nouns-1"></a>
<h3 class="section">2.4 Verbs as well as Nouns</h3>

<p>Object oriented languages have a very finely developed sense of the
noun. An object is intrinsically a noun; objects reference concrete or
abstract things that a programmer is manipulating. The notation of
classes, interfaces, inheritance and so on represents a powerful set
of concepts for organizing the application&rsquo;s nouns.
</p>
<p>However, just as in spoken languages like English, verbs are also
important: what you do with objects is at least as important as the
objects themselves. Most OO languages do not treat verbs â
a.k.a. methods â with the same respect that they confer on nouns.
</p>
<p>The result is that methods are written using a vocabulary that a
programmer in the 1970&rsquo;s would be completely familiar with â even when
the same programmer would find classes and interfaces novel concepts.
</p>
<p>Functional languages give more weight to the verbs. A function is a
first class value and there are many ways in which functions can be
combined and abstracted. The result is that the expression of control
in a functional language can be subtler and more expressive than is
possible in most OO languages. This makes a material difference to the
productivity of the programmer and can also make a difference in the
readability of the code.
</p>
<hr>
<a name="Non_002dsequential-Code"></a>
<div class="header">
<p>
Previous: <a href="#Verbs-as-well-as-Nouns" accesskey="p" rel="prev">Verbs as well as Nouns</a>, Up: <a href="#Functional-Programming" accesskey="u" rel="up">Functional Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Non_002dsequential-Code-1"></a>
<h3 class="section">2.5 Non-sequential Code</h3>
<p>Another benefit that perhaps explains some of the modern excitement is
that functional programming represents a more tractable route to
developing parallel and multi-threaded programs.
</p>
<p>A program written in a classic von Neumann style is best understood in
terms of instructions to a simple machine. Each successive instruction
modifies the state of the machine in some way â such as storing values
in cells or printing a result.
</p>
<p>The issue with this programming model is that modern machines do not
fit the original von Neumann model very well. It is normal now for a
single computer to have eight &lsquo;cores&rsquo;, which permit up to 16
independently executing tasks to execute in parallel. Furthermore,
modern graphics processors come with thousands of cores â which do not
necessarily have to be processing graphics!
</p>
<p>Traditional procedural programming languages have a very difficult
time with multi-threaded and parallel programs. Because of the
complexity of writing them safely, they must currently be written by
&lsquo;programming masters&rsquo;.
</p>


<hr>
<a name="Contract-Oriented-Programming"></a>
<div class="header">
<p>
Previous: <a href="#Functional-Programming" accesskey="p" rel="prev">Functional Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Contract-Oriented-Programming-1"></a>
<h2 class="chapter">3 Contract Oriented Programming</h2>

<p>The concept of a contract is fundamental to good software
engineering. This is because it allows separation between the
specification of a concept and its implementation.
</p>
<p>A Star contract takes the form of a description of a set of functions
and values &ndash; in effect a type. For example, the contract for basic
arithmetic is
</p><div class="example">
<pre class="example">contract all t ~~ arith[t] ::= {
    (+) : (t,t)=&gt;t.
    (-) : (t,t)=&gt;t.
    (*) : (t,t)=&gt;t.
    (/) : (t,t)=&gt;t.
    one : t.
    zero : t.
}
</pre></div>

<p>This has the effect of declaring a group of functions that work
together to form a basic arithmetic suite.
</p>
<p>Once defined, a contract can be used simply by mentioning one of its
members. Thus, in Star, all arithmetic depends on the arith contract:
</p><div class="example">
<pre class="example">fact(0) =&gt; 1.
fact(X) =&gt; X*fact(X-1)
</pre></div>
<p>The connection between the use of operators such as <code>+</code> and
<code>*</code> and the appropriate definitions is automatically computed by
the compiler.
</p>
<p>Furthermore, if we want to state that the type of a variable is
&lsquo;something&rsquo; that implements a contract we can do so by adding a
constraint to the variable&rsquo;s type:
</p><div class="example">
<pre class="example">F : arith[t] |: t
</pre></div>

<p>This has the effect to declaring that F&rsquo;s type is a type variable â
but one that is constrained such that whatever concrete type it
eventually gets, it must be one that is defined for arith.
</p>
<p>In fact, however, this version of factorial is not the most
paradigmatic (sic) version. The reason is that the type signature for
fact is not generic but tied to integer:
</p><div class="example">
<pre class="example">fact:(integer)=&gt;integer
</pre></div>
<p>The reason that fact is not fully generic is interesting: itâs the
presence of the literal numbers 0 and 1 in the program. The type of
any literal integer is integer! This is enough to force the type of
fact to be restricted to integers.  In particular, Star does not
support implicit coercion, including coercion of literal numbers from
integer to any other type.
</p>
<p>The solution is simple, if a little strange: we declared in the
<code>arith</code> contract two non-function entries: <code>zero</code> and
<code>one</code>.  By explicitly identifying zero and one as elements of the
arith contract we can use them in lieu of 0 and 1 respectively without
committing to integers.<a name="DOCF2" href="#FOOT2"><sup>2</sup></a>
</p>
<p>Using these, we can write a much more paradigmatic version of the
factorial function:
</p><div class="example">
<pre class="example">factorial(zero) =&gt; one.
factorial(N) =&gt; factorial(N-one)*N.
</pre></div>
<p>This function is quite generic, and its type signature is given by:
</p><div class="example">
<pre class="example">factorial: all t ~~ arith[t] |: (t)=&gt;t.
</pre></div>
<blockquote>
<p><b>Note:</b> Of course, in this case, our definition of factorial is not well
defined for the real numbers; but that is a different issue!
</p></blockquote>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top">&bull; <a href="#Contracts-as-Interfaces" accesskey="1">Contracts as Interfaces</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top">&bull; <a href="#Accessing-Collections" accesskey="2">Accessing Collections</a>:</td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Contracts-as-Interfaces"></a>
<div class="header">
<p>
Next: <a href="#Accessing-Collections" accesskey="n" rel="next">Accessing Collections</a>, Up: <a href="#Contract-Oriented-Programming" accesskey="u" rel="up">Contract Oriented Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Contracts-as-Interfaces-1"></a>
<h3 class="section">3.1 Contracts as Interfaces</h3>

<p>At their most basic, contracts are a way of denoting &lsquo;overloaded&rsquo;
functions. I.e., by giving different implementations of a contract for
different types, it is possible to provide multiple implementations of
a function. For example, there are several implementations of arith
for integers, floats, and so on. It is also straightforward to
implement arith for your own type.
</p>
<p>However, another pattern of use of contracts is as an analog of
interfaces. For example, we saw in Actors that actors used speech
actions to express communication between them.
</p>
<p>In fact, there are many entities that can handle speech actions. In
addition to basic actors, Star also has concurrent actors â which have
a completely different implementation.
</p>
<p>In addition to these implementations we can envisage many other
entities that will want to be able to handle speech actions.
</p>
<p>To enable all these diverse uses of speech actions we encapsulate the
semantics of speech actions in a contract:
</p><div class="example">
<pre class="example">contract all t ~~ speech[t] ::= {
  _notify:all x ~~ (t,(x)=&gt;())=&gt;().
  _query: all x,s ~~ (t,(x)=&gt;s) =&gt; s.
  _request: all x ~~ (t,(x)=&gt;())=&gt;()
}
</pre></div>

<p>As we shall see in Application = Policy + Mechanism, a speech action such as:
</p><div class="example">
<pre class="example">query A with list of {  X | X in R }
</pre></div>
<p>is translated by macros into the call to the function _query:
</p><div class="example">
<pre class="example">_query(A,(AA) =&gt; list of { X | X in AA.R })
</pre></div>
<p>Now the role of the speech contract may be highlighted: it serves as
the specification of the semantics of speech actions. More informally,
one can think of the language of speech actions as a kind of
&lsquo;ceiling&rsquo;: the DSL defines a language that is embedded within
Star. The speech contract, on the other hand, represents a &lsquo;floor&rsquo; to
the speech action language.
</p>
<p>As a specification of semantics, contracts do not address all the
issues. It is not possible, for example, to express that
implementations of arithmetic obey the normal Peano axioms of
arithmetic. However, it is possible to place assertions in a contract
that are verified when the implementation is created.
</p>
<hr>
<a name="Accessing-Collections"></a>
<div class="header">
<p>
Previous: <a href="#Contracts-as-Interfaces" accesskey="p" rel="prev">Contracts as Interfaces</a>, Up: <a href="#Contract-Oriented-Programming" accesskey="u" rel="up">Contract Oriented Programming</a> &nbsp; [<a href="#SEC_Contents" title="Table of contents" rel="contents">Contents</a>]</p>
</div>
<a name="Accessing-Collections-1"></a>
<h3 class="section">3.2 Accessing Collections</h3>
<p>Contracts are deeply embedded within the Star language. For example,
consider the task of accessing a collection. This is captured in the
standard indexable contract; which includes a definition of the _index
function. It includes other functions too; which we omit in this
discussion.
</p>
<div class="example">
<pre class="example">contract all c,k,v ~~ indexable[c-&gt;&gt;k,v] ::= {
  _index:(c,k)=&gt;option[v]
  &hellip;
}
</pre></div>
<p>The <code>_index</code> function is rarely used directly; instead it is
accessed via the index expression, as in:
</p><div class="example">
<pre class="example">L[34]
</pre></div>
<p>Accessing collections always introduces the element of tentativeness:
it cannot normally be shown at compile time that <code>L[34]</code>
exists. Star does not have the equivalent of Java null values; instead
we make extensive use of the option type when we want to represent a
tentative result.
</p>
<p>Thus the type of <code>L[34]</code> is not <code>integer</code>, but
</p><div class="example">
<pre class="example">option[integer]
</pre></div>
<p>This indexable contract also introduces an important feature of contracts: functional dependencies. The clause:
</p><div class="example">
<pre class="example">indexable[c-&gt;&gt;k,v]
</pre></div>
<p>declares that any implementation of indexable for a type â c â will
&lsquo;fix&rsquo; two further types â in this case the &lsquo;index type&rsquo; and the
&lsquo;element type&rsquo; of the elements of the collection.
</p>
<p>For example, the implementation of indexable for the standard list
type starts with:
</p><div class="example">
<pre class="example">implementation all t ~~ indexable[list[t]-&gt;&gt;integer,t] =&gt; &hellip;
</pre></div>
<p>This states that implementing indexable for lists requires that the
index type is an integer and that the element type is the type of the
element of the list. Much as one might expect. This allows expressions
like <code>L[34]</code> to be typed as expected.
</p>
<p>The indexable contract is also implemented for associative
dictionaries. In this case the index type is the type of the keys in
the dictionary and the element type is the type of the values in the
dictionary:
</p><div class="example">
<pre class="example">implementation all k,v ~~ indexable[dictionary[k,v]-&gt;&gt;k,v] =&gt; â¦
</pre></div>
<p>Thus, if we had a dictionary M whose keys were strings and whose values were integer, then the expression:
</p><div class="example">
<pre class="example">M[&quot;alpha&quot;]
</pre></div>
<p>would have the type <code>option[integer]</code>.
</p>
<p>There is no requirement that the index type be a simple type. For
example, consider the representation of JSON values. The standard
infoset type allows JSON values to be represented abstractly in a way
that permits easy processing of the data.
</p>
<p>The most appropriate way of extracting elements from a JSON/infoset value is by using a path. For example, the path to the image title in the JSON value:
</p><div class="example">
<pre class="example">{
  &quot;Image&quot;: {
    &quot;Width&quot;: 800,
    &quot;Height&quot;: 600,
    &quot;Title&quot;: &quot;View from 15th Floor&quot;,
    &quot;Thumbnail&quot;: {
      &quot;Url&quot;: &quot;http://www.example.com/image/481989943&quot;,
      &quot;Height&quot;: 125,
      &quot;Width&quot;: &quot;100&quot;
    },
    &quot;IDs&quot;: [116, 943, 234, 38793]
  }
}
</pre></div>
<p>might be expressed as <code>Image.Title</code>, and the last ID might be
expressed as the path <code>Image.IDS</code>. If the infoset of this value were
bound to the variable I, then we can express these values using the
expressions:
</p><div class="example">
<pre class="example">I[[kString(&quot;Image&quot;),kString(&quot;Title&quot;)]]
</pre></div>
<p>and
</p><div class="example">
<pre class="example">I[[kString(&quot;Image&quot;), kString(&quot;IDs&quot;), kInt(3)]]
</pre></div>
<p>respectively.
</p>
<p>Note that the elements of the path are not simply bare strings and
integers. This is because a structure like:
</p><div class="example">
<pre class="example">[1, &quot;fred&quot;, 2]
</pre></div>
<p>is not well typed. The elements of the path are from the iKey type
which is written as an algebraic type definition:
</p><div class="example">
<pre class="example">iKey ::= kString(string) | kInt(integer)
</pre></div>
<p>Wrapping the path elements as iKey values makes the path expression a
legal Star value.
</p>
<p>In summary, the simple contract specification for indexing can be
applied to lists (arrays), to associative dictionaries and to
tree-like structures. This has a powerful unifying effect on Star
programs.
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p>As opposed to a
systems-oriented programming language like C.</p>
<h3><a name="FOOT2" href="#DOCF2">(2)</a></h3>
<p>There is some Mathematical
justification for this: the arith contract defines a Field which
requires zero elements for the two operators (+ and *).</p>
</div>
<hr>



</body>
</html>

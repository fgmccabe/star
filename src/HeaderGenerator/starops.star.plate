/* Automatically generated, do not edit */

star.compiler.operators{
  import star.

  import star.compiler.ast.
  import star.compiler.location.

  public astGenerator ::= .noGen
             | genUnary((locn,ast)=>ast)
             | genBinary((locn,ast,ast)=>ast).

  operator ::= prefixOp(integer,integer,astGenerator)
             | infixOp(integer,integer,integer,astGenerator)
             | postfixOp(integer,integer,astGenerator).

  public bracket ::= bkt(string,string,string,integer).

  public isOperator:(string)=>boolean.
  isOperator(Nm) => size(oper(Nm))>0.

  public isInfixOp:(string) => option[(integer,integer,integer,astGenerator)].
  isInfixOp(Nm) => pickInfix(oper(Nm)).

  pickInfix:(cons[operator]) => option[(integer,integer,integer,astGenerator)].
  pickInfix([]) => .none.
  pickInfix([infixOp(Lf,Pr,Rg,Gen),.._]) => some((Lf,Pr,Rg,Gen)).
  pickInfix([_,..L]) => pickInfix(L).

  public isPrefixOp:(string) => option[(integer,integer,astGenerator)].
  isPrefixOp(Nm) => pickPrefix(oper(Nm)).

  pickPrefix:(cons[operator]) => option[(integer,integer,astGenerator)].
  pickPrefix([]) => .none.
  pickPrefix([prefixOp(Pr,Rg,Gen),.._]) => some((Pr,Rg,Gen)).
  pickPrefix([_,..L]) => pickPrefix(L).

  public isPostfixOp:(string) => option[(integer,integer,astGenerator)].
  isPostfixOp(Nm) => pickPostfix(oper(Nm)).

  pickPostfix:(cons[operator]) => option[(integer,integer,astGenerator)].
  pickPostfix([]) => .none.
  pickPostfix([postfixOp(Pr,Rg,Gen),.._]) => some((Pr,Rg,Gen)).
  pickPostfix([_,..L]) => pickPrefix(L).

  oper:(string)=>cons[operator].
#(Operators)  oper(_) default => [].

  public isBracket:(string) => option[bracket].
#(Brackets)  isBracket(_) default => .none.

  public isLeftBracket:(string) => boolean.
  isLeftBracket(S) => bkt(S,_,_,_) ^= isBracket(S).

  public isRightBracket:(string) => boolean.
  isRightBracket(S) => bkt(_,_,S,_) ^= isBracket(S).

  public first:(integer) => option[string].
#(First)  first(_) default => .none.

  public follows:(string,integer) => option[string].
#(Follows)  follows(_,_) default => .none.

  public final:(string) => boolean.
#(Final)  final(_) default => .false.

  public keyword:(string) => boolean.
#(Keywords)  keyword(_) default => .false.
}
